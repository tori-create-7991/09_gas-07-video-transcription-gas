services:
  # ローカルファイル変換（従来の方法）
  converter:
    build: .
    volumes:
      - ./input:/input
      - ./output:/output

  # Google Drive連携変換
  drive-converter:
    build:
      context: .
      dockerfile: Dockerfile.drive
    volumes:
      # サービスアカウントの認証ファイル
      - ./credentials:/app/credentials:ro
    environment:
      # 動画があるDriveフォルダID
      - INPUT_FOLDER_ID=${INPUT_FOLDER_ID}
      # M4Aを保存するDriveフォルダID
      - OUTPUT_FOLDER_ID=${OUTPUT_FOLDER_ID}
      # 既存ファイルをスキップするか
      - SKIP_EXISTING=true
